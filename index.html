<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>বাংলায় ওয়েব সিকিউরিটি টিউটোরিয়াল — ইন্টারঅ্যাকটিভ</title>

<!-- Prism for code highlighting -->
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.css" rel="stylesheet"/>

<style>
  :root{
    --bg:#081025;
    --card:#0f1724;
    --muted:#9aa7b3;
    --accent:#00c2d4;
    --glass: rgba(255,255,255,0.03);
    --glass-2: rgba(255,255,255,0.02);
    --radius: 14px;
    --card-radius: 16px;
    --shadow-1: 0 6px 18px rgba(2,6,23,0.6);
    --shadow-2: 0 12px 36px rgba(2,6,23,0.75);
    --ease: cubic-bezier(.19,1,.22,1);
  }

  /* Basic reset */
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family: Inter, "Segoe UI", Roboto, system-ui, -apple-system, "Noto Sans Bengali", sans-serif;
    background: linear-gradient(180deg,var(--bg) 0%, #021226 100%);
    color:#e6eef3;
    -webkit-font-smoothing:antialiased;
    text-rendering:optimizeLegibility;
    line-height:1.55;
    overflow-y: auto;
    padding: 28px;
    perspective:1200px;
  }

  header.hero{
    text-align:center;
    padding:28px 12px 16px;
    margin-bottom:18px;
  }
  header.hero h1{
    margin:0;
    font-size:2.05rem;
    letter-spacing: -0.02em;
    color: #eafcff;
    text-shadow: 0 6px 24px rgba(0,194,212,0.08);
  }
  header.hero p{
    margin:8px auto 0;
    color:var(--muted);
    max-width:760px;
  }

  /* Parallax background container */
  .parallax {
    position:relative;
    height:60px;
    margin-bottom:28px;
    overflow:hidden;
    border-radius: calc(var(--radius) - 4px);
    box-shadow: var(--shadow-1);
    background: linear-gradient(180deg, rgba(0,0,0,0.15), rgba(255,255,255,0.02));
  }
  .layer {
    position:absolute;
    inset:0;
    background-repeat:no-repeat;
    background-position:center;
    background-size:cover;
    will-change:transform,opacity;
    transform-origin:center center;
    transition: transform 0.3s var(--ease), opacity 0.3s ease;
    opacity:0.95;
    filter: saturate(1.05) contrast(1.02);
  }
  .bg1{ background-image: url('assets/bg1.jpg'); z-index:1; opacity:0.85; }
  .bg2{ background-image: url('assets/bg2.png'); z-index:2; opacity:0.65; mix-blend-mode:screen;}
  .bg3{ background-image: url('assets/bg3.png'); z-index:3; opacity:0.45; filter: blur(6px) saturate(0.9);}

  /* Cards grid */
  .cards {
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap:20px;
    align-items:start;
    margin-bottom:32px;
  }

  .card {
    background: linear-gradient(180deg, rgba(255,255,255,0.02), var(--glass));
    border-radius: var(--card-radius);
    padding:18px;
    cursor:pointer;
    transform-style:preserve-3d;
    transition: transform 350ms var(--ease), box-shadow 350ms var(--ease), background 350ms var(--ease);
    box-shadow: 0 4px 18px rgba(2,8,20,0.5);
    border: 1px solid rgba(255,255,255,0.03);
    min-height:120px;
    display:flex;
    flex-direction:column;
    justify-content:center;
    position:relative;
    overflow:hidden;
  }

  .card .title{ font-size:1.05rem; font-weight:700; color:#eafcff; margin-bottom:6px; }
  .card .desc{ color:var(--muted); font-size:0.95rem; line-height:1.35; }

  .card::after{
    content:'';
    position:absolute;
    inset:0;
    pointer-events:none;
    background: linear-gradient(180deg, rgba(0,194,212,0.02), transparent 30%);
    mix-blend-mode:overlay;
    opacity:0;
    transition: opacity 240ms ease;
  }

  .card:hover{
    transform: translateY(-8px) rotateX(6deg) scale(1.02);
    box-shadow: 0 18px 46px rgba(0,194,212,0.12);
  }
  .card:hover::after{ opacity:1; }

  /* subtle inner highlight */
  .card .glow {
    position:absolute;
    right:-40%;
    top:-40%;
    width:220px;height:220px;
    background: radial-gradient(circle at 30% 30%, rgba(0,194,212,0.12), transparent 40%);
    transform: translateZ(30px) rotate(12deg);
    pointer-events:none;
    transition: transform 400ms var(--ease);
  }

  /* Modal */
  #modal {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    z-index:999;
    background: rgba(2,6,20,0.6);
    backdrop-filter: blur(6px) saturate(1.05);
  }
  #modal.open{ display:flex; }

  .modal-wrap{
    width: min(960px, 94%);
    max-height: 86vh;
    overflow:auto;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius: calc(var(--card-radius) + 4px);
    padding:20px;
    box-shadow: var(--shadow-2);
    transform-origin: center center;
    transition: transform 360ms var(--ease), opacity 280ms ease;
    position: relative;
    border:1px solid rgba(255,255,255,0.04);
  }

  .modal-header{
    display:flex; align-items:center; gap:12px; margin-bottom:12px;
  }
  .modal-header h2{ margin:0; font-size:1.25rem; color:#eafcff; }
  .modal-controls{ margin-left:auto; display:flex; gap:8px; align-items:center; }

  .modal-body{
    color:#d8e6ef;
    font-size:0.98rem;
  }

  /* Code area */
  pre {
    background: #0b1220;
    padding:14px;
    border-radius:10px;
    overflow:auto;
    margin:12px 0;
    font-size:0.9rem;
    border:1px solid rgba(255,255,255,0.03);
    box-shadow: inset 0 0 28px rgba(0,0,0,0.45);
  }

  /* Copy button inside modal */
  .code-toolbar {
    position: relative;
  }
  .copy-code {
    position: absolute;
    right:12px;
    top:8px;
    background:var(--accent);
    color:#051021;
    border:none;
    padding:6px 10px;
    border-radius:8px;
    font-weight:700;
    cursor:pointer;
    box-shadow: 0 8px 20px rgba(0,194,212,0.12);
    transform-origin:center;
    transition: transform 220ms cubic-bezier(.2,.9,.3,1), box-shadow 200ms;
  }
  .copy-code:active{ transform: translateY(1px) scale(0.98); box-shadow:0 6px 12px rgba(0,194,212,0.1);}
  .copy-code.copied{
    background: #4ee0c8;
    transform: scale(1.06);
    animation: pop 420ms cubic-bezier(.2,.9,.3,1);
  }
  @keyframes pop{ 0%{ transform: scale(.9);} 60%{ transform: scale(1.07);} 100%{ transform: scale(1);} }

  /* Modal micro parallax header */
  .modal-hero{
    position:relative; overflow:hidden; border-radius:10px; padding:10px;
    background: linear-gradient(90deg, rgba(0,194,212,0.06), rgba(65,85,110,0.02));
    margin-bottom:12px;
    transform-style:preserve-3d;
  }
  .modal-hero .mh-layer{
    position:absolute; inset:0; background-repeat:no-repeat; background-position:center; background-size:cover; will-change:transform;
    opacity:0.12; mix-blend-mode:screen;
  }

  /* modal navigation */
  .modal-nav{ display:flex; gap:8px; margin-top:12px; }
  .btn {
    background:transparent; border:1px solid rgba(255,255,255,0.06);
    color:var(--muted); padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:600;
  }
  .btn.primary{ background:var(--accent); color:#031222; border:none; box-shadow: 0 10px 30px rgba(0,194,212,0.08); }

  /* back-to-top */
  #backTop {
    position: fixed; right:22px; bottom:22px;
    width:48px;height:48px;border-radius:50%;
    background: linear-gradient(180deg,var(--accent), #00aabf);
    display:flex; align-items:center; justify-content:center;
    box-shadow: 0 10px 30px rgba(0,194,212,0.15);
    cursor:pointer; border:none;
    transform: translateY(10px); opacity:0; transition:opacity 300ms var(--ease), transform 300ms var(--ease);
    z-index: 1200;
  }
  #backTop.show{ opacity:1; transform: translateY(0); }

  /* accessibility focus */
  :focus { outline: none; }
  .focus-ring{ box-shadow: 0 0 0 3px rgba(0,194,212,0.14); border-radius:8px; }

  /* Responsiveness */
  @media (max-width:700px){
    .cards{ grid-template-columns: repeat(auto-fit, minmax(150px,1fr)); gap:14px; }
    .parallax{ height:180px; }
    .modal-wrap{ width:94%; padding:14px; }
    pre{ font-size:0.85rem; }
  }

  /* Respect reduced motion */
  @media (prefers-reduced-motion: reduce){
    .card, .modal-wrap, .layer, #backTop { transition: none !important; animation: none !important; transform: none !important; }
  }
</style>
</head>
<body>

<header class="hero" role="banner">
  <h1>বাংলা সাইবার সিকিউরিটি টিউটোরিয়াল</h1>
  <p>সোজা ভাষায় কোড ও ব্যাখ্যা — বাংলাদেশি ডেভ/শিক্ষার্থীর জন্য। ক্লিক করে শেখা শুরু করুন।</p>
</header>

<!-- Parallax Section -->
<section class="parallax" aria-hidden="true">
  <div class="layer bg1" data-speed="1.6"></div>
  <div class="layer bg2" data-speed="3.2"></div>
  <div class="layer bg3" data-speed="6.8"></div>
</section>

<!-- Cards (topics will be generated by JS too) -->
<main class="cards" id="cards" role="main" aria-label="Topics">
  <!-- Cards are inserted here by JS for maintainability -->
</main>

<!-- Modal -->
<div id="modal" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal-wrap" role="document">
    <div class="modal-header">
      <div>
        <h2 id="modal-title">Title</h2>
        <div class="modal-hero" id="modal-hero" aria-hidden="true">
          <div class="mh-layer" style="background-image:linear-gradient(90deg, rgba(0,194,212,0.12), rgba(255,255,255,0.02));"></div>
        </div>
      </div>
      <div class="modal-controls" aria-hidden="false">
        <div class="modal-nav">
          <button id="prevTopic" class="btn" title="আগে">← আগের</button>
          <button id="nextTopic" class="btn" title="পরের">পরের →</button>
        </div>
        <div style="width:10px"></div>
        <button id="closeModal" class="btn" aria-label="Close">বন্ধ</button>
      </div>
    </div>

    <div class="modal-body" id="modal-body">
      <!-- Content injected here -->
    </div>
    <div style="height:16px"></div>
  </div>
</div>

<button id="backTop" aria-label="Back to top">⬆</button>

<!-- Prism -->
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>

<script>
/* =========================
   Topic content (Bangla + code + breakdown)
   IMPORTANT: keep keys in the order you want modal navigation.
   ========================= */
const topics = [
  {
    id: 'plaintext-vs',
    title: 'Plaintext vs Encoding vs Encryption vs Hashing',
    body: `
      <div class="modal-hero" aria-hidden="true">
        <div class="mh-layer" style="background-image: radial-gradient(circle at 20% 20%, rgba(0,194,212,0.12), transparent 20%);"></div>
      </div>

      <p><strong>সংক্ষিপ্ত ধারণা</strong>: প্লেইনটেক্সট হল আসল বার্তা; এনকোডিং কেবল সাজায়; এনক্রিপশন ডেটাকে লক করে; হ্যাশিং হলো একমুখী ফিঙ্গারপ্রিন্ট।</p>

      <div class="code-toolbar">
        <button class="copy-code" data-code-index="0">Copy</button>
        <pre><code class="language-python" data-code="plaintext-example">
message = "hello world"  # প্লেইনটেক্সট

import base64
encoded = base64.b64encode(message.encode())
print(encoded)  # b'aGVsbG8gd29ybGQ=' (এনকোডেড)

from cryptography.fernet import Fernet
key = Fernet.generate_key()
cipher = Fernet(key)
encrypted = cipher.encrypt(message.encode())
print(encrypted)  # এনক্রিপ্টেড

decrypted = cipher.decrypt(encrypted).decode()
print(decrypted)  # ডিক্রিপ্টেড

import hashlib
hashed = hashlib.sha256(message.encode()).hexdigest()
print(hashed)  # হ্যাশ
        </code></pre>
      </div>

      <h3>লাইন-বাই-লাইন ব্যাখ্যা</h3>
      <ul>
        <li><code>message = "hello world"</code> — প্লেইনটেক্সট: সরাসরি পাঠযোগ্য। (Analogy: খাঁচা পাখি)</li>
        <li><code>message.encode()</code> — স্ট্রিংকে বাইটে রূপান্তর। (কম্পিউটার বাইটে ডাটা চায়)</li>
        <li><code>base64.b64encode(...)</code> — ডাটা সাজানো, পাঠযোগ্য করে তোলা (নিরাপদ নয়)।</li>
        <li><code>Fernet.generate_key()</code> — এনক্রিপশনের জন্য কী তৈরি করা। (গোপন চাবি)</li>
        <li><code>cipher.encrypt(...)</code> এবং <code>cipher.decrypt(...)</code> — এনক্রিপ্ট ও ডিক্রিপ্ট।</li>
        <li><code>hashlib.sha256(...)</code> — একমুখী হ্যাশ তৈরি; ডিক্রিপ্ট করা যায় না। (আঙুলের ছাপ)</li>
      </ul>
      <p><em> সংক্ষেপে: এনকোডিং পোশাক বদলের মত; এনক্রিপশন তালাবদ্ধ বাক্স; হ্যাশিং ফিঙ্গারপ্রিন্ট।</em></p>
    `
  },

  {
    id: 'encoding-common',
    title: '৭.১ সাধারণ Encoding পদ্ধতি',
    body: `
      <p><strong>সারাংশ</strong>: UTF-8, Base64 ও URL-encoding কীভাবে কাজ করে ও কখন ব্যবহার করবেন।</p>

      <div class="code-toolbar">
        <button class="copy-code" data-code-index="1">Copy</button>
        <pre><code class="language-python" data-code="encoding-example">
import base64
from urllib.parse import quote

data = "বাংলা ভাষা"
utf8_encoded = data.encode('utf-8')
b64_encoded = base64.b64encode(utf8_encoded)
url_encoded = quote(data)

print(utf8_encoded)
print(b64_encoded)
print(url_encoded)
        </code></pre>
      </div>

      <h3>বিস্তারিত</h3>
      <ol>
        <li><code>UTF-8</code> — স্ট্যান্ডার্ড স্ট্রিং->বাইট রূপান্তর, ওয়েবে মূল।</li>
        <li><code>Base64</code> — বাইনারি টেক্সটে রূপান্তর, ইমেইল/API-তে দরকার।</li>
        <li><code>URL encoding</code> — ইউআরএল-এ বিশেষ ক্যারেক্টার নিরাপদভাবে পাঠানো।</li>
      </ol>
    `
  },

  {
    id: 'encryption',
    title: '৭.২ এনক্রিপশন (Encryption)',
    body: `
      <p><strong>সারাংশ</strong>: Symmetric (Fernet/AES) ও Asymmetric (RSA) এনক্রিপশনের মূল ধারণা ও উদাহরণ।</p>

      <div class="code-toolbar">
        <button class="copy-code" data-code-index="2">Copy</button>
        <pre><code class="language-python" data-code="encryption-example">
from cryptography.fernet import Fernet

key = Fernet.generate_key()
cipher = Fernet(key)

message = "গোপন বার্তা".encode()

encrypted_message = cipher.encrypt(message)
print("Encrypted:", encrypted_message)

decrypted_message = cipher.decrypt(encrypted_message).decode()
print("Decrypted:", decrypted_message)
        </code></pre>
      </div>

      <h3>লাইন-বাই-লাইন</h3>
      <ul>
        <li><code>Fernet.generate_key()</code> — সিকিউর কী তৈরি করে (সিমেট্রিক)।</li>
        <li><code>cipher.encrypt(...)</code> — বাইটসকে এনক্রিপ্ট করে টোকেন তৈরি করে।</li>
        <li><code>cipher.decrypt(...)</code> — সঠিক কী থাকলে ডিক্রিপ্ট করে আসল বার্তা দেয়।</li>
      </ul>
      <p>🔒 এনক্রিপশন ডাটা কনফিডেনশিয়ালিটি নিশ্চিত করে — কী না থাকলে ডিক্রিপ্ট করা যায় না।</p>
    `
  },

  {
    id: 'hashing',
    title: '৭.৩ Hashing ও One-way ফাংশন',
    body: `
      <p><strong>সারসংক্ষেপ</strong>: SHA-256, bcrypt, Argon2, কখন কোনটা ব্যবহার করবেন।</p>

      <div class="code-toolbar">
        <button class="copy-code" data-code-index="3">Copy</button>
        <pre><code class="language-python" data-code="hashing-example">
import hashlib

message = "important data"
hash_obj = hashlib.sha256(message.encode())
print("SHA256 Hash:", hash_obj.hexdigest())
        </code></pre>
      </div>

      <h3>বিস্তারিত</h3>
      <p>হ্যাশিং হলো একমুখী; পাসওয়ার্ড সংরক্ষণে স্লো ও সল্টেড হ্যাশ (bcrypt/Argon2) ব্যবহার করুন।</p>
    `
  },

  {
    id: 'hashing-speeds',
    title: '৭.৪ Hashing Speed Cheatsheet',
    body: `
      <p>শর্ট টেবিল — কোন হ্যাশ দ্রুত/ধীর এবং পাসওয়ার্ডে কোনটা ব্যবহার করবেন:</p>
      <pre><code class="language-text"># Hashing Algorithm    Speed (Approx)
SHA-1                 Fast
SHA-256               Moderate
bcrypt                Slow (designed to be slow)
Argon2                Slow (memory & CPU hard)
scrypt                Slow (memory hard)</code></pre>
      <p>🔑 পাসওয়ার্ডের জন্য স্লো হ্যাশ: bcrypt/Argon2/scrypt.</p>
    `
  },

  {
    id: 'password-policies',
    title: '৮.১ পাসওয়ার্ড নীতি (Password Policies)',
    body: `
      <p><strong>মাস্টার নোট</strong>: শক্ত পাসওয়ার্ড ব্যবহার, পাসফ্রেজ প্রোমোট করুন, পাসওয়ার্ড ম্যানেজার।</p>
      <pre><code class="language-text"># সাধারণ পাসওয়ার্ড নীতি:
- কমপক্ষে ৮ অক্ষর (আর ভাল হলে 12+)
- বড় ও ছোট হাতের অক্ষর
- সংখ্যা ও স্পেশাল ক্যারেক্টার
- পাসওয়ার্ড ম্যানেজার ব্যবহার</code></pre>
    `
  },

  {
    id: 'storing-passwords',
    title: '৮.২ পাসওয়ার্ড সংরক্ষণ',
    body: `
      <p><strong>ভুলকথা</strong>: পাসওয়ার্ড সরাসরি DB-তে রাখা (অবিলম্বে ভুল)।</p>

      <div class="code-toolbar">
        <button class="copy-code" data-code-index="4">Copy</button>
        <pre><code class="language-python" data-code="bcrypt-example">
import bcrypt

password = "cute@123".encode()
salt = bcrypt.gensalt()
hashed = bcrypt.hashpw(password, salt)
print("Hashed Password:", hashed)

# যাচাই:
if bcrypt.checkpw("cute@123".encode(), hashed):
    print("Matched")
        </code></pre>
      </div>

      <h3>বিস্তারিত</h3>
      <p>সল্ট হ্যাশ ব্যবহার করুন; সরাসরি স্টোর করা থেকে বাঁচুন; Argon2/ bcrypt প্রেফার করুন।</p>
    `
  },

  {
    id: 'passwordless',
    title: '৮.৩ পাসওয়ার্ড ছাড়া জীবন',
    body: `
      <p>পাসওয়ার্ডলেস: WebAuthn, Magic Links, OTP, বায়োমেট্রিকস — উন্নত UX এবং সিকিউরিটি।</p>
    `
  },

  {
    id: 'public-key',
    title: 'পাবলিক কী ক্রিপ্টোগ্রাফি',
    body: `
      <div class="code-toolbar">
        <button class="copy-code" data-code-index="5">Copy</button>
        <pre><code class="language-python" data-code="rsa-example">
from cryptography.hazmat.primitives.asymmetric import rsa, padding
from cryptography.hazmat.primitives import hashes

private_key = rsa.generate_private_key(public_exponent=65537, key_size=2048)
public_key = private_key.public_key()

message = b"সিক্রেট বার্তা"
encrypted = public_key.encrypt(
    message,
    padding.OAEP(mgf=padding.MGF1(hashes.SHA256()), algorithm=hashes.SHA256(), label=None)
)
decrypted = private_key.decrypt(
    encrypted,
    padding.OAEP(mgf=padding.MGF1(hashes.SHA256()), algorithm=hashes.SHA256(), label=None)
)
print(decrypted.decode())
        </code></pre>
      </div>

      <p>বর্ণনা: পাবলিক কী দিয়ে এনক্রিপ্ট, প্রাইভেট কী দিয়ে ডিক্রিপ্ট — ব্যাপকভাবে TLS/PKI-তে ব্যবহৃত।</p>
    `
  },

  {
    id: 'sessions',
    title: 'সেশন: আমাকে মনে রাখুন',
    body: `
      <div class="code-toolbar">
        <button class="copy-code" data-code-index="6">Copy</button>
        <pre><code class="language-python" data-code="flask-session-example">
from flask import Flask, session

app = Flask(__name__)
app.secret_key = "সিক্রেট কি"

@app.route('/login')
def login():
    session['user'] = "ResearchAEOArticle"
    return "লগইন সফল"
        </code></pre>
      </div>

      <p>সেশন কুকি/টোকেনের মাধ্যমে ইউজারের স্টেট ধরে রাখে; HttpOnly, Secure, SameSite ব্যবহার করুন।</p>
    `
  },

  {
    id: 'state-storage',
    title: '১০.১ স্টেট কোথায় সেভ করবেন?',
    body: `
      <p>স্টেট সার্ভার-সাইডে (Redis/DB) বা JWT-এর মাধ্যমে রাখুন — তবে JWT রাখলে নিরাপত্তা বিবেচনা প্রয়োজন।</p>
    `
  },

  {
    id: 'invalidate-session',
    title: '১০.২ সেশন বাতিল করা',
    body: `
      <p>লগআউট বা টোকেন রিফ্রেশের সময় সেশন/টোকেন ইনভ্যালিড করে দিন। সার্ভার সাইডে ব্ল্যাকলিস্ট/রিভোকেশন স্ট্রাটেজি ব্যবহার করুন।</p>
    `
  },

  {
    id: 'cookies',
    title: '১০.৩ কুকি মনস্টার & আপনি',
    body: `
      <p>কুকিতে HttpOnly, Secure এবং SameSite flag দিন। সেনসেটিভ ডাটা কুকিতে রাখবেন না।</p>
    `
  },

  {
    id: 'secure-headers',
    title: '১১.১ সিকিউর ওয়েব হেডারস',
    body: `
      <div class="code-toolbar">
        <button class="copy-code" data-code-index="7">Copy</button>
        <pre><code class="language-python" data-code="secure-headers-example">
@app.after_request
def secure_headers(response):
    response.headers['Content-Security-Policy'] = "default-src 'self'"
    response.headers['X-Frame-Options'] = 'DENY'
    response.headers['Strict-Transport-Security'] = 'max-age=31536000; includeSubDomains'
    return response
        </code></pre>
      </div>

      <p>সিকিউরিটি হেডারগুলো ব্রাউজারকে নির্দেশ দেয় কীভাবে আচরণ করতে — সবসময় যুক্ত করুন।</p>
    `
  },

  {
    id: 'sri',
    title: '১১.২ ৩য় পক্ষের কোডের ডাটা ইন্টেগ্রিটি (SRI)',
    body: `
      <p>Subresource Integrity (SRI) ব্যবহার করে CDN-থেকে লোড হওয়া কোডের হ্যাশ যাচাই করুন — পরিবর্তিত হলে লোড ব্লক হবে।</p>
    `
  },

  {
    id: 'pinning',
    title: '১১.৩ সার্টিফিকেট পিনিং',
    body: `
      <p>ব্যকএন্ড/মোবাইল ক্লায়েন্টে সার্টিফিকেট পিনিং প্রয়োগ করলে MITM রিস্ক কমে, তবে কী রোটেশনের কৌশল ঠিক রাখতে হবে।</p>
    `
  },

  {
    id: 'provisioning',
    title: '১২.১ ক্লাউড প্রোভিশনিং: পোর্ট, Shodan & AWS',
    body: `
      <p>রিমোট সার্ভারে ওপেন পোর্ট দেখলে সরাসরি সিকিউরিটি রিস্ক। Shodan দিয়ে পরীক্ষা করুন এবং AWS security groups ঠিক রাখুন।</p>
    `
  },

  {
    id: 'debug-mode',
    title: '১২.২ "হানী, Debug mode খোলা রেখেছো"',
    body: `
      <p>প্রোডাকশনে ডিবাগ মোড বন্ধ রাখুন — ডিটেইলড ত্রুটি ম্যাসেজ হ্যাকারদের সাহায্য করে।</p>
    `
  },

  {
    id: 'logging',
    title: '১২.৩ লগিং (অথবা না করা)',
    body: `
      <p>লগিং করুন কিন্তু সেনসেটিভ ডাটা (পাসওয়ার্ড, টোকেন) লগ করবেন না। লগ এ্যানোনিমাইজ করুন এবং রোটেশন রাখুন।</p>
    `
  },

  {
    id: 'monitoring',
    title: '১২.৪ মনিটরিং',
    body: `
      <p>ইনট্রুঝন ডিটেকশন ও মনিটরিং প্ল্যাটফর্ম ব্যবহার করে সন্দেহপ্রবণ কার্যকলাপ ধরুন।</p>
    `
  },

  {
    id: 'least-privilege',
    title: '১২.৫ সর্বনিম্ন অনুমতির নীতি',
    body: `
      <p>প্রত্যেক সার্ভিস/ইউজারকে সবচেয়ে কম অনুমতি দিন — এই নীতিই ক্ষতির সীমা নির্ধারণ করে।</p>
    `
  },

  {
    id: 'rate-captcha',
    title: '১২.৬ রেট লিমিটিং ও ক্যাপচা',
    body: `
      <div class="code-toolbar">
        <button class="copy-code" data-code-index="8">Copy</button>
        <pre><code class="language-python" data-code="rate-limit-example">
from flask_limiter import Limiter
from flask_limiter.util import get_remote_address

limiter = Limiter(key_func=get_remote_address)

@app.route('/login')
@limiter.limit("5 per minute")
def login():
    return "৫ বার/মিনিট লগইন অনুমতি।"
        </code></pre>
      </div>
      <p>বট ও ব্রুটফোর্স আক্রমণ থেকে রক্ষা করতে রেট লিমিট ও ক্যাপচা প্রয়োগ করুন।</p>
    `
  },

  {
    id: 'secrets',
    title: '১২.৭ প্রজেক্ট সিক্রেট ও পাসওয়ার্ড ফাইল',
    body: `
      <p>সিক্রেটস কখনো সোর্স কোডে রাখবেন না। ব্যবহার করুন environment variables বা Secret Manager (Cloud).</p>
    `
  },

  {
    id: 'dns',
    title: '১২.৮ DNS: সাবডোমেইন ও ভুলে যাওয়া প্রজেক্ট',
    body: `
      <p>পুরানো সাবডোমেইন নিরাপত্তা ঝুঁকি বাড়ায় — নিয়মিত পরিষ্কার ও রিভিউ করুন।</p>
    `
  },

  {
    id: 'patching',
    title: '১২.৯ প্যাচিং এবং আপডেট',
    body: `
      <p>নিয়মিত প্যাচিং ও ডিপেন্ডেন্সি আপডেট সিকিউরিটির প্রথম সারি। অটোমেটেড প্যাচিংও বিবেচনা করুন।</p>
    `
  },

  {
    id: 'final',
    title: 'ফাইনাল সারাংশ ও ম্যান্ট্রা',
    body: `
      <p style="font-weight:700; color:var(--accent); font-size:1.05rem;">
        "প্লেইনটেক্সট হলো আসল বার্তা, এনকোডিং শুধু সাজানো, এনক্রিপশন মানে গোপন বাক্সের চাবি, আর হ্যাশিং হলো সেই বাক্সের ছাপ— যা থেকে আসল চাবি খুঁজে পাওয়া অসম্ভব।"
      </p>
      <p>শিক্ষা চালিয়ে যান — প্রয়োগ করুন — সুরক্ষিত থাকুন।</p>
    `
  }
]; // end topics

/* ========= Utility & UI logic ========= */
const cardsContainer = document.getElementById('cards');
const modal = document.getElementById('modal');
const modalWrap = document.querySelector('.modal-wrap');
const modalTitle = document.getElementById('modal-title');
const modalBody = document.getElementById('modal-body');
const closeModalBtn = document.getElementById('closeModal');
const prevBtn = document.getElementById('prevTopic');
const nextBtn = document.getElementById('nextTopic');
const backTop = document.getElementById('backTop');

let currentIndex = 0;
let lastFocused = null;

/* Generate cards */
function createCards(){
  topics.forEach((t, i) => {
    const card = document.createElement('article');
    card.className = 'card';
    card.setAttribute('role','button');
    card.setAttribute('tabindex','0');
    card.setAttribute('data-index', String(i));
    card.innerHTML = `
      <div class="glow"></div>
      <div class="title">${t.title}</div>
      <div class="desc">${(t.body.match(/<p>(.*?)<\/p>/i) || ['',''])[1] || ''}</div>
    `;
    // simple accessibility label
    card.setAttribute('aria-label', t.title);
    // click / keyboard
    card.addEventListener('click', ()=> openTopic(i));
    card.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openTopic(i); }
    });
    // subtle tilt on mousemove
    card.addEventListener('mousemove', (ev)=> {
      const rect = card.getBoundingClientRect();
      const cx = rect.left + rect.width/2;
      const cy = rect.top + rect.height/2;
      const dx = (ev.clientX - cx) / rect.width;
      const dy = (ev.clientY - cy) / rect.height;
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      card.style.transform = `translateY(-8px) rotateX(${(-dy*6).toFixed(2)}deg) rotateY(${(dx*6).toFixed(2)}deg) scale(1.02)`;
    });
    card.addEventListener('mouseleave', ()=> {
      card.style.transform = '';
    });

    cardsContainer.appendChild(card);
  });
}

/* Parallax scroll for background using rAF and throttling */
(function parallaxLoop(){
  const layers = [...document.querySelectorAll('.layer')];
  let lastY = window.scrollY;
  let ticking = false;
  function update(){
    const scrollY = window.scrollY;
    layers.forEach(layer => {
      const speed = parseFloat(layer.dataset.speed) || 1;
      const y = scrollY * (speed/12); // tuned factor
      layer.style.transform = `translateY(${y}px) scale(${1 + speed*0.002})`;
    });
    lastY = scrollY;
    ticking = false;
  }
  window.addEventListener('scroll', ()=> {
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
    if (!ticking){
      ticking = true;
      requestAnimationFrame(update);
    }
    // back to top visibility
    if(window.scrollY > 260) backTop.classList.add('show'); else backTop.classList.remove('show');
  }, {passive:true});
})();

/* Open modal with topic content */
function openTopic(index){
  lastFocused = document.activeElement;
  currentIndex = index;
  renderModal(index);
  document.body.style.overflow = 'hidden'; // prevent background scroll
  modal.classList.add('open');
  modal.setAttribute('aria-hidden','false');
  // focus close button after showing
  setTimeout(()=> closeModalBtn.focus(), 180);
}

/* Close modal */
function closeModal(){
  modal.classList.remove('open');
  modal.setAttribute('aria-hidden','true');
  document.body.style.overflow = '';
  if(lastFocused) lastFocused.focus();
}

/* Render modal content */
function renderModal(i){
  const t = topics[i];
  modalTitle.textContent = t.title;
  modalBody.innerHTML = t.body + `<div class="modal-nav" style="margin-top:18px;"><button class="btn" id="modalPrevInline">← আগের</button><button class="btn primary" id="modalNextInline">পরের →</button></div>`;
  attachCopyHandlers();
  attachInlineNav();
  runModalMicroParallax();
  Prism.highlightAllUnder(modalBody);
}

/* Inline prev/next inside modal */
function attachInlineNav(){
  const prevInline = document.getElementById('modalPrevInline');
  const nextInline = document.getElementById('modalNextInline');
  prevInline.addEventListener('click', ()=> { navigate(-1); });
  nextInline.addEventListener('click', ()=> { navigate(1); });
  prevInline.disabled = (currentIndex === 0);
  nextInline.disabled = (currentIndex === topics.length-1);
}

/* Prev/next handlers */
function navigate(direction){
  const next = currentIndex + direction;
  if(next < 0 || next >= topics.length) return;
  currentIndex = next;
  renderModal(currentIndex);
}

/* Hook header nav outside modal */
prevBtn.addEventListener('click', ()=> navigate(-1));
nextBtn.addEventListener('click', ()=> navigate(1));
closeModalBtn.addEventListener('click', closeModal);

/* Close on overlay click or ESC */
modal.addEventListener('click', (e)=>{
  if(e.target === modal){ closeModal(); }
});
document.addEventListener('keydown', (e)=>{
  if(e.key === 'Escape' && modal.classList.contains('open')) closeModal();
});

/* Back to top */
backTop.addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'}));

/* Copy code support for code blocks inside modal */
function attachCopyHandlers(){
  // remove previous bindings
  modalBody.querySelectorAll('.copy-code').forEach(btn => btn.remove());
  // attach to each code-toolbar (we placed buttons earlier in some topics) or add for each pre
  modalBody.querySelectorAll('pre').forEach((pre, idx) => {
    // if a copy button already exists inside this pre, skip
    let existing = pre.parentElement.querySelector('.copy-code');
    if(existing) {
      // ensure listener
      existing.onclick = ()=> copyPre(pre, existing);
      return;
    }
    const btn = document.createElement('button');
    btn.className = 'copy-code';
    btn.type = 'button';
    btn.innerText = 'Copy';
    btn.addEventListener('click', ()=> copyPre(pre, btn));
    pre.parentElement.insertBefore(btn, pre);
  });
}

/* copy function */
function copyPre(pre, button){
  const code = pre.querySelector('code');
  if(!code) return;
  const text = code.textContent;
  navigator.clipboard.writeText(text).then(()=>{
    button.classList.add('copied');
    button.innerText = 'Copied!';
    setTimeout(()=> { button.classList.remove('copied'); button.innerText = 'Copy'; }, 1400);
  }).catch(()=> {
    // fallback: select and prompt
    const range = document.createRange();
    range.selectNodeContents(code);
    const sel = window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);
    try { document.execCommand('copy'); button.innerText='Copied!'; setTimeout(()=> button.innerText='Copy',1400); } catch(e){ alert('Copy failed — use Ctrl+C'); }
    sel.removeAllRanges();
  });
}

/* Micro parallax inside modal header for depth */
function runModalMicroParallax(){
  const hero = modalBody.querySelector('.modal-hero') || document.getElementById('modal-hero');
  if(!hero) return;
  // simple mousemove parallax on hero
  function onMove(e){
    const rect = hero.getBoundingClientRect();
    const cx = rect.left + rect.width/2;
    const cy = rect.top + rect.height/2;
    const dx = (e.clientX - cx) / rect.width;
    const dy = (e.clientY - cy) / rect.height;
    hero.style.transform = `translateZ(8px) rotateX(${(-dy*3).toFixed(2)}deg) rotateY(${(dx*3).toFixed(2)}deg)`;
    // move inner layers if any
    hero.querySelectorAll('.mh-layer').forEach((layer, idx) => {
      const speed = (idx+1) * 6;
      layer.style.transform = `translate(${dx*speed}px, ${dy*speed}px)`;
    });
  }
  function onLeave(){ hero.style.transform=''; hero.querySelectorAll('.mh-layer').forEach(l=> l.style.transform=''); }
  hero.addEventListener('mousemove', onMove);
  hero.addEventListener('mouseleave', onLeave);
  // cleanup when modal closes
  modal.addEventListener('transitionend', ()=> {
    if(!modal.classList.contains('open')) { hero.removeEventListener('mousemove', onMove); hero.removeEventListener('mouseleave', onLeave); }
  }, {once: true});
}

/* focus trap - basic */
modal.addEventListener('keydown', (e)=>{
  if(e.key !== 'Tab') return;
  const focusable = modal.querySelectorAll('button, a, [tabindex]:not([tabindex="-1"]), input, select, textarea');
  if(!focusable.length) return;
  const first = focusable[0], last = focusable[focusable.length -1];
  if(e.shiftKey){
    if(document.activeElement === first){ e.preventDefault(); last.focus(); }
  } else {
    if(document.activeElement === last){ e.preventDefault(); first.focus(); }
  }
});

/* Initialize cards */
createCards();

/* Expose a little API to navigate externally via index */
window.openTopicById = (id) => {
  const idx = topics.findIndex(t => t.id === id);
  if(idx>=0) openTopic(idx);
};

/* initial highlighting for possible static code blocks */
Prism.highlightAll();

/* Accessibility: add focus ring for keyboard users */
document.addEventListener('keyup', (e)=>{
  if(e.key === 'Tab'){
    document.body.classList.add('show-focus');
  }
});
</script>
</body>
</html>
